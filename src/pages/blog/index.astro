---
import BaseLayout from "../../layouts/BaseLayout.astro";

// Eagerly import all MDX files from src/content
const modules = import.meta.glob('../../content/*.mdx', { eager: true });

const posts = Object.entries(modules).map(([path, mod]) => {
  // @ts-ignore - MDX modules expose frontmatter
  const fm = mod.frontmatter || {};
  const slug = path.split('/').pop()?.replace(/\.mdx?$/, '');
  return { slug, ...fm };
}).sort((a, b) => new Date(b.date) - new Date(a.date));
---

<BaseLayout title="Blog â€” Abba Unveiled">
  <h1 class="text-2xl font-semibold mb-6">Blog</h1>
  <ul class="grid gap-6">
    {posts.map((p) => (
      <li>
        <a href={`/blog/${p.slug}/`} class="block">
          <h2 class="text-xl font-medium">{p.title}</h2>
          <p class="text-sm text-gray-600">{p.date && new Date(p.date).toLocaleDateString()}</p>
          <p class="mt-1 text-gray-700">{p.summary}</p>
        </a>
      </li>
    ))}
  </ul>
</BaseLayout>

